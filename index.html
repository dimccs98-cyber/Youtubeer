<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Player</title>
    <style>
        /* 强制占满全屏，背景纯黑 */
        body, html { 
            margin: 0; 
            padding: 0; 
            height: 100%; 
            width: 100%; 
            background-color: #000; 
            overflow: hidden; 
        }
        /* 播放器容器 */
        #player { 
            position: absolute; 
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 100%; 
        }
    </style>
</head>
<body>

    <div id="player"></div>

    <script>
        // 1. 加载 YouTube IFrame API
        var tag = document.createElement('script');
        tag.src = "https://www.youtube.com/iframe_api";
        var firstScriptTag = document.getElementsByTagName('script')[0];
        firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

        var player;
        function onYouTubeIframeAPIReady() {
            // 兼容两种参数名: ?v=ID 或 ?videoId=ID
            const urlParams = new URLSearchParams(window.location.search);
            const videoId = urlParams.get('v') || urlParams.get('videoId');

            if (videoId) {
                player = new YT.Player('player', {
                    height: '100%',
                    width: '100%',
                    videoId: videoId,
                    // 【关键优化1】强制使用无 Cookie 域名，解决登录弹窗问题
                    host: 'https://www.youtube-nocookie.com',
                    playerVars: {
                        'autoplay': 1,        // 自动播放
                        'controls': 1,        // 【关键优化2】强制显示底部控制条(进度条/音量等)
                        'fs': 1,              // 【关键优化3】显示全屏按钮
                        'rel': 0,             // 播放结束后不推荐相关视频
                        'playsinline': 1,     // 让视频在 WebView 内部播放，而不是弹出系统播放器
                        'modestbranding': 1,  // 简化 Logo
                        'iv_load_policy': 3,  // 隐藏视频注释
                        'cc_load_policy': 0,  // 默认关闭字幕
                        'disablekb': 0,       // 允许键盘控制
                        'origin': window.location.origin // 解决跨域报错
                    },
                    events: {
                        'onReady': onPlayerReady,
                        'onError': onPlayerError
                    }
                });
            } else {
                console.error("Video ID not found");
            }
        }

        function onPlayerReady(event) {
            // 确保视频静音以尝试通过浏览器的自动播放策略（可选，先注释掉）
            // event.target.mute(); 
            // event.target.playVideo();
        }

        function onPlayerError(event) {
            console.error("Error playing video:", event.data);
        }
    </script>
</body>
</html>
